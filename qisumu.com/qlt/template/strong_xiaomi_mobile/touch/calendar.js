var controlid=null;var currdate=null;var startdate=null;var enddate=null;var halfhour=false;var yy=null;var mm=null;var hh=null;var ii=null;var currday=null;var addtime=false;var today=new Date();var lastcheckedyear=false;var lastcheckedmonth=false;var calendarrecall=null;function loadcalendar(){s="";s+='<div id="calendar" style="display:none; position:absolute; z-index:100000;" onclick="doane(event)">';s+='<div style="width: 210px;"><table cellspacing="0" cellpadding="0" width="100%" style="text-align: center;">';s+='<tr align="center" id="calendar_week"><td onclick="refreshcalendar(yy, mm-1)" title="��һ��" style="cursor: pointer;"><a href="javascript:;">&laquo;</a></td><td colspan="5" style="text-align: center"><a href="javascript:;" onclick="showdiv(\'year\');doane(event)" class="dropmenu" title="���ѡ�����" id="year"></a>&nbsp; - &nbsp;<a id="month" class="dropmenu" title="���ѡ���·�" href="javascript:;" onclick="showdiv(\'month\');doane(event)"></a></td><td onclick="refreshcalendar(yy, mm+1)" title="��һ��" style="cursor: pointer;"><a href="javascript:;">&raquo;</a></td></tr>';s+='<tr id="calendar_header"><td>��</td><td>һ</td><td>��</td><td>��</td><td>��</td><td>��</td><td>��</td></tr>';for(var A=0;A<6;A++){s+="<tr>";for(var C=1;C<=7;C++){s+="<td id=d"+(A*7+C)+' height="19">0</td>'}s+="</tr>"}s+='<tr id="hourminute" class="pns"><td colspan="4" align="left"><input type="text" size="1" value="" id="hour" class="px vm" onKeyUp=\'this.value=this.value > 23 ? 23 : zerofill(this.value);controlid.value=controlid.value.replace(/\\d+(:\\d+)/ig, this.value+"$1")\'>��';s+='<span id="fullhourselector"><input type="text" size="1" value="" id="minute" class="px vm" onKeyUp=\'this.value=this.value > 59 ? 59 : zerofill(this.value);controlid.value=controlid.value.replace(/(\\d+:)\\d+/ig, "$1"+this.value)\'>��</span>';s+='<span id="halfhourselector"><select id="minutehalfhourly" onchange=\'this.value=this.value > 59 ? 59 : zerofill(this.value);controlid.value=controlid.value.replace(/(\\d+:)\\d+/ig, "$1"+this.value)\'><option value="00">00</option><option value="30">30</option></select>��</span>';s+='</td><td align="right" colspan="3"><button class="pn" onclick="confirmcalendar();"><em>ȷ��</em></button></td></tr>';s+="</table></div></div>";s+='<div id="calendar_year" onclick="doane(event)" style="display: none;z-index:100001;"><div class="col">';for(var D=2020;D>=1931;D--){s+=D!=2020&&D%10==0?'</div><div class="col">':"";s+='<a href="javascript:;" onclick="refreshcalendar('+D+", mm);$('calendar_year').style.display='none'\"><span"+(today.getFullYear()==D?' class="calendar_today"':"")+' id="calendar_year_'+D+'">'+D+"</span></a><br />"}s+="</div></div>";s+='<div id="calendar_month" onclick="doane(event)" style="display: none;z-index:100001;">';for(var D=1;D<=12;D++){s+='<a href="javascript:;" onclick="refreshcalendar(yy, '+(D-1)+");$('calendar_month').style.display='none'\"><span"+(today.getMonth()+1==D?' class="calendar_today"':"")+' id="calendar_month_'+D+'">'+D+(D<10?"&nbsp;":"")+" ��</span></a><br />"}s+="</div>";if(BROWSER.ie&&BROWSER.ie<7){s+='<iframe id="calendariframe" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>';s+='<iframe id="calendariframe_year" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>';s+='<iframe id="calendariframe_month" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>'}var B=document.createElement("div");B.innerHTML=s;$("append_parent").appendChild(B);document.onclick=function(E){closecalendar(E)};$("calendar").onclick=function(E){doane(E);$("calendar_year").style.display="none";$("calendar_month").style.display="none";if(BROWSER.ie&&BROWSER.ie<7){$("calendariframe_year").style.display="none";$("calendariframe_month").style.display="none"}}}function closecalendar(A){$("calendar").style.display="none";$("calendar_year").style.display="none";$("calendar_month").style.display="none";if(BROWSER.ie&&BROWSER.ie<7){$("calendariframe").style.display="none";$("calendariframe_year").style.display="none";$("calendariframe_month").style.display="none"}}function parsedate(B){/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec(B);var E=(RegExp.$1&&RegExp.$1>1899&&RegExp.$1<2101)?parseFloat(RegExp.$1):today.getFullYear();var F=(RegExp.$2&&(RegExp.$2>0&&RegExp.$2<13))?parseFloat(RegExp.$2):today.getMonth()+1;var A=(RegExp.$3&&(RegExp.$3>0&&RegExp.$3<32))?parseFloat(RegExp.$3):today.getDate();var C=(RegExp.$4&&(RegExp.$4>-1&&RegExp.$4<24))?parseFloat(RegExp.$4):0;var D=(RegExp.$5&&(RegExp.$5>-1&&RegExp.$5<60))?parseFloat(RegExp.$5):0;/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec("0000-00-00 00:00");return new Date(E,F-1,A,C,D)}function settime(d){if(!addtime){$("calendar").style.display="none";$("calendar_month").style.display="none";if(BROWSER.ie&&BROWSER.ie<7){$("calendariframe").style.display="none"}}controlid.value=yy+"-"+zerofill(mm+1)+"-"+zerofill(d)+(addtime?" "+zerofill($("hour").value)+":"+zerofill($((halfhour)?"minutehalfhourly":"minute").value):"");if(typeof calendarrecall=="function"){calendarrecall()}else{eval(calendarrecall)}}function confirmcalendar(){if(addtime&&controlid.value===""){controlid.value=today.getFullYear()+"-"+(today.getMonth()+1)+"-"+today.getDate()+" "+zerofill($("hour").value)+":"+zerofill($((halfhour)?"minutehalfhourly":"minute").value)}closecalendar()}function initclosecalendar(){var A=getEvent();var B=A.target||A.srcElement;while(B.parentNode!=document.body){if(B.parentNode.id=="append_parent"){B.onclick=function(){closecalendar(A)}}B=B.parentNode}}function showcalendar(E,G,D,B,H,A,F){controlid=G;addtime=D;startdate=B?parsedate(B):false;enddate=H?parsedate(H):false;currday=controlid.value?parsedate(controlid.value):today;hh=currday.getHours();ii=currday.getMinutes();halfhour=A?true:false;calendarrecall=F?F:null;var C=fetchOffset(controlid);$("calendar").style.display="block";$("calendar").style.left=C["left"]+"px";$("calendar").style.top=(C["top"]+20)+"px";doane(E);refreshcalendar(currday.getFullYear(),currday.getMonth());if(lastcheckedyear!=false){$("calendar_year_"+lastcheckedyear).className="calendar_default";$("calendar_year_"+today.getFullYear()).className="calendar_today"}if(lastcheckedmonth!=false){$("calendar_month_"+lastcheckedmonth).className="calendar_default";$("calendar_month_"+(today.getMonth()+1)).className="calendar_today"}$("calendar_year_"+currday.getFullYear()).className="calendar_checked";$("calendar_month_"+(currday.getMonth()+1)).className="calendar_checked";$("hourminute").style.display=addtime?"":"none";lastcheckedyear=currday.getFullYear();lastcheckedmonth=currday.getMonth()+1;if(halfhour){$("halfhourselector").style.display="";$("fullhourselector").style.display="none"}else{$("halfhourselector").style.display="none";$("fullhourselector").style.display=""}if(BROWSER.ie&&BROWSER.ie<7){$("calendariframe").style.top=$("calendar").style.top;$("calendariframe").style.left=$("calendar").style.left;$("calendariframe").style.width=$("calendar").offsetWidth;$("calendariframe").style.height=$("calendar").offsetHeight;$("calendariframe").style.display="block"}initclosecalendar()}function refreshcalendar(F,D){var E=new Date(F,D,1);var A=E.getDay();var C=E.getDate();var G=null;yy=E.getFullYear();mm=E.getMonth();$("year").innerHTML=yy;$("month").innerHTML=mm+1>9?(mm+1):"0"+(mm+1);for(var B=1;B<=A;B++){G=$("d"+B);G.innerHTML="&nbsp;";G.className=""}while(E.getMonth()==mm){G=$("d"+(C+A));G.style.cursor="pointer";G.onclick=function(){settime(this.childNodes[0].innerHTML);doane()};G.innerHTML='<a href="javascript:;">'+C+"</a>";if(E.getTime()<today.getTime()||(enddate&&E.getTime()>enddate.getTime())||(startdate&&E.getTime()<startdate.getTime())){G.className="calendar_expire"}else{G.className="calendar_default"}if(E.getFullYear()==today.getFullYear()&&E.getMonth()==today.getMonth()&&E.getDate()==today.getDate()){G.className="calendar_today";G.firstChild.title="����"}if(E.getFullYear()==currday.getFullYear()&&E.getMonth()==currday.getMonth()&&E.getDate()==currday.getDate()){G.className="calendar_checked"}E.setDate(++C)}while(C+A<=42){G=$("d"+(C+A));G.innerHTML="&nbsp;";C++}if(addtime){$("hour").value=zerofill(hh);$("minute").value=zerofill(ii)}}function showdiv(B){var A=fetchOffset($(B));$("calendar_"+B).style.left=A["left"]+"px";$("calendar_"+B).style.top=(A["top"]+16)+"px";$("calendar_"+B).style.display="block";if(BROWSER.ie&&BROWSER.ie<7){$("calendariframe_"+B).style.top=$("calendar_"+B).style.top;$("calendariframe_"+B).style.left=$("calendar_"+B).style.left;$("calendariframe_"+B).style.width=$("calendar_"+B).offsetWidth;$("calendariframe_"+B).style.height=$("calendar_"+B).offsetHeight;$("calendariframe_"+B).style.display="block"}}function zerofill(A){var A=parseFloat(A.toString().replace(/(^[\s0]+)|(\s+$)/g,""));A=isNaN(A)?0:A;return(A<10?"0":"")+A.toString()}if(!BROWSER.other){loadcss("forum_calendar");loadcalendar()};